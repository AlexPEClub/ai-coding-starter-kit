# RBAC & LBAC Configuration Example
# This file demonstrates the hierarchical RBAC system with Biba Integrity Model and LoDV.

# --- ACTIONS ---
# Actions map hierarchical resources to permissions and severity-based visibility.
actions:
  # Basic internal records
  - id: ReadProtectedRecords
    resources:
      - id: organization/records
        access:
          - sensitivity: Protected
            permissions: [read]
            visibility: ClearText

  # Complex finance action with multi-level access
  - id: ManageFinance
    resources:
      - id: organization/finance/payroll
        access:
          - sensitivity: Confidential
            permissions: [all]
            visibility: ClearText
      - id: organization/finance/invoices
        access:
          - sensitivity: Restricted
            permissions: [read, update]
            visibility: PartialMasking
        approvals:
          - permissions: [update]
            required_approvers: 2
            valid_duration: 1h
    access:
      - sensitivity: Protected
        permissions: [read]
        visibility: Redaction

  # PII data visibility mapping
  - id: ReadEmployeePII
    resources:
      - id: organization/hr/employees/*/pii
    access:
      - sensitivity: Confidential
        permissions: [read]
        visibility: ClearText
      - sensitivity: Restricted
        permissions: [read]
        visibility: PartialMasking
      - sensitivity: Protected
        permissions: [read]
        visibility: Redaction

  # Password handling (Mandatory Anonymization for non-owners)
  - id: ManagePasswords
    resources:
      - id: "**/passwords"
    access:
      - sensitivity: Restricted
        permissions: [update]
        visibility: Anonymization
      - sensitivity: Protected
        permissions: [none]
        visibility: Redaction

  # Personal profile with ownership
  - id: ManageOwnProfile
    resources:
      - id: organization/users/:owner/profile
    # Ownership logic automatically grants 'all' and ClearText

  - id: ManageProjects
    resources:
      - id: organization/engineering/projects
    access:
      - sensitivity: Restricted
        permissions: [all]

  # System-wide Admin Action
  - id: AdminAccess
    resources:
      - id: organization
    access:
      - sensitivity: Confidential
        permissions: [read, update]
        visibility: ClearText
      - sensitivity: Restricted
        permissions: [read]
        visibility: Redaction

  # Global SuperAdmin Action
  - id: GlobalAdmin
    resources:
      - id: organization
    access:
      - sensitivity: Secret
        permissions: [all]
        visibility: ClearText

  # System Administration Action
  - id: SystemMaintenance
    resources:
      - id: organization
    access:
      - sensitivity: Secret
        permissions: [read, update]
      - sensitivity: Confidential
        permissions: [read, update]
      - sensitivity: Restricted
        permissions: [read, update]
      - sensitivity: Protected
        permissions: [read, update]
    approvals:
      - permissions: [update]
        required_approvers: 1
        valid_duration: 2h
        max_operations: 1

# --- ROLES ---
# Roles aggregate actions and support single inheritance (enhancement).
roles:
  - id: Employee
    actions:
      - ReadProtectedRecords

  - id: Developer
    parent: Employee
    actions:
      - ManageProjects

  - id: Accountant
    parent: Employee
    actions:
      - ManageFinance

  - id: FinanceAuditor
    parent: Accountant
    approvable_actions:
      - action: ManageFinance
        permissions: [update]

  - id: HRManager
    parent: Employee
    actions:
      - ReadEmployeePII

  - id: Admin
    parent: Employee
    actions:
      - AdminAccess
      - SystemMaintenance

  - id: SuperAdmin
    parent: Admin
    actions:
      - GlobalAdmin
    approvable_actions:
      - action: SystemMaintenance
        permissions: [update]
      - action: ManageFinance
        permissions: [update]

# --- SCOPES ---
# Scopes provide a limiting intersection mask (only one active at a time).
scopes:
  # Limits user to 'read' only, regardless of role permissions
  - id: GuestScope
    permissions: [read]
    resources: ["**"]

  # Regional restriction for developers
  - id: ProjectAlphaScope
    resources:
      - id: organization/engineering/projects/alpha
        permissions: [all]
      - id: organization/engineering/projects
        permissions: [none]

  # Audit-specific restriction: Read-only for finance, no access elsewhere
  - id: AuditorScope
    resources:
      - id: organization/finance
        permissions: [read]
      - id: organization/engineering
        permissions: [none] # Explicitly denies access

# --- USERS ---
# User assignments map users to roles, clearance levels, and optional scopes.
users:
  - id: "USR-001"
    name: "Alice Admin"
    clearance: Secret
    roles:
      - id: SuperAdmin

  - id: "USR-008"
    name: "Ian Admin"
    clearance: Confidential
    roles:
      - id: Admin

  - id: "USR-002"
    name: "Bob Accountant"
    clearance: Confidential
    roles:
      - id: Accountant

  - id: "USR-003"
    name: "Charlie Developer"
    clearance: Restricted
    roles:
      - id: Developer

  - id: "USR-004"
    name: "Dave HR"
    clearance: Confidential
    roles:
      - id: HRManager

  - id: "USR-005"
    name: "Eve Junior"
    clearance: Protected
    roles:
      - id: Employee

  - id: "USR-006"
    name: "Frank External"
    clearance: Public
    roles:
      - id: Employee
    scope: GuestScope

  - id: "USR-007"
    name: "Grace Alpha"
    clearance: Restricted
    roles:
      - id: Developer
    scope: ProjectAlphaScope

  - id: "USR-009"
    name: "Heidi MultiRole"
    clearance: Confidential
    roles:
      - id: Developer
        clearance: Restricted
      - id: HRManager
        clearance: Confidential

  - id: "USR-010"
    name: "Jack Auditor"
    clearance: Protected
    roles:
      - id: FinanceAuditor
    scope: AuditorScope

  - id: "USR-011"
    name: "Kelly Finance"
    clearance: Restricted
    roles:
      - id: FinanceAuditor
